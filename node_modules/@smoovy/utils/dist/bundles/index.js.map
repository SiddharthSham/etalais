{"version":3,"file":"index.js","sources":["../../src/browser.ts","../../src/math.ts","../../src/throttle.ts","../../src/base.ts","../../src/object.ts","../../src/element.ts","../../src/range.ts","../../src/resolver.ts","../../src/uid.ts","../../src/fetch.ts","../../src/url.ts"],"sourcesContent":["export class Browser {\n  public static get uA() {\n    return navigator.userAgent.toLowerCase();\n  }\n\n  public static get pf() {\n    return navigator.platform.toLowerCase();\n  }\n\n  public static get safari() {\n    return (/^((?!chrome|android).)*safari/).test(this.uA);\n  }\n\n  public static get safariVersion() {\n    return +(\n      this.uA.match(/version\\/[\\d\\.]+.*safari/) || ['-1']\n    )[0].replace(/^version\\//, '').replace(/ safari$/, '');\n  }\n\n  public static get firefox() {\n    return this.uA.indexOf('firefox') > -1;\n  }\n\n  public static get chrome() {\n    return (/chrome/).test(this.uA);\n  }\n\n  public static get ie() {\n    return (/msie|trident/).test(this.uA);\n  }\n\n  public static get ieMobile() {\n    return (/iemobile/).test(this.uA);\n  }\n\n  public static get webkit() {\n    return (/webkit/).test(this.uA);\n  }\n\n  public static get operaMini() {\n    return (/opera mini/).test(this.uA);\n  }\n\n  public static get edge() {\n    return (/edge\\/\\d./).test(this.uA);\n  }\n\n  public static get ios() {\n    return (/ip(hone|[ao]d)/).test(this.uA);\n  }\n\n  public static get mac() {\n    return this.pf.indexOf('mac') > -1;\n  }\n\n  public static get windows() {\n    return this.pf.indexOf('win') > -1;\n  }\n\n  public static get android() {\n    return (/android/).test(this.uA);\n  }\n\n  public static get androidMobile() {\n    return (/android.*mobile/).test(this.uA);\n  }\n\n  public static get blackberry() {\n    return (/blackberry/).test(this.uA);\n  }\n\n  public static get mobile() {\n    return this.ieMobile ||\n           this.blackberry ||\n           this.androidMobile ||\n           this.ios ||\n           this.operaMini;\n  }\n\n  /* istanbul ignore next */\n  public static get mouseWheelEvent() {\n    return 'onmousewheel' in document;\n  }\n\n  /* istanbul ignore next */\n  public static get wheelEvent() {\n    return 'onwheel' in document;\n  }\n\n  /* istanbul ignore next */\n  public static get keydownEvent() {\n    return 'onkeydown' in document;\n  }\n\n  /* istanbul ignore next */\n  public static get touchDevice() {\n    return 'ontouchstart' in window;\n  }\n\n  /* istanbul ignore next */\n  public static get mutationObserver() {\n    return 'MutationObserver' in window;\n  }\n\n  /* istanbul ignore next */\n  public static get client() {\n    return typeof window !== 'undefined' &&\n           typeof window.document !== 'undefined';\n  }\n}\n","export function mapRange(\n  value: number,\n  inStart: number,\n  inEnd: number,\n  outMin: number,\n  outMax: number,\n): number {\n  return outMin + (outMax - outMin) / (inEnd - inStart) * (value - inStart);\n}\n\nexport function clamp(\n  value: number,\n  min: number,\n  max: number,\n) {\n  return Math.min(Math.max(value, min), max);\n}\n\nexport function lerp(\n  s: number,\n  e: number,\n  m: number\n) {\n  return s * (1 - m) + e * m;\n}\n\nexport function between(num: number, a: number, b: number) {\n  return num > Math.min(a, b) && num < Math.max(a, b);\n}\n\nexport function roundDec(\n  value: number,\n  precision: number\n) {\n  return Number(\n    Math.round(value + ('e' as any) + precision) + 'e-' + precision\n  );\n}\n\nexport function cutDec(\n  value: number,\n  precision: number\n) {\n  const str = value.toString();\n\n  return parseFloat(str.substring(0, str.indexOf('.') + 1 + precision));\n}\n","export function throttle(\n  cb: Function,\n  ms: number = 0,\n  ctx?: any\n): (...args: any[]) => void {\n  let lastTime = 0;\n  let applyTimeout: any;\n\n  return (...args) => {\n    const now = (performance || /* istanbul ignore next */ Date).now();\n\n    if (lastTime && now < lastTime + ms) {\n      clearTimeout(applyTimeout);\n\n      applyTimeout = setTimeout(function () {\n        lastTime = now;\n        cb.apply(ctx, args);\n      }, ms);\n    } else {\n      lastTime = now;\n\n      cb.apply(ctx, args);\n    }\n  };\n}\n","type Value<T> = T | undefined | null | void;\n\nexport function isDef<T>(val: Value<T>): val is T {\n  return typeof val !== void 0 && val !== undefined;\n}\n\nexport function isNum<T>(val: Value<T>): val is T {\n  return typeof val === 'number';\n}\n\nexport function isStr<T>(val: Value<T>): val is T {\n  return typeof val === 'string';\n}\n\nexport function isArr<T>(val: Value<T>): val is T {\n  return Array.isArray(val);\n}\n\nexport function isObj<T>(val: Value<T>): val is T {\n  const type = typeof val;\n\n  return !isArr(val) && (\n    type === 'object' &&\n    val != null ||\n    type === 'function'\n  );\n}\n\nexport function isFunc<T>(val: Value<T>): val is T {\n  return typeof val === 'function';\n}\n\n","import { isObj } from './base';\n\ninterface DefaultObject {\n  [id: string]: any;\n}\n\nexport function objectDeepMerge<T extends DefaultObject>(\n  target: T,\n  ...sources: DefaultObject[]\n): T {\n  if ( ! sources.length) {\n    return target;\n  }\n\n  const source = sources.shift();\n\n  if (isObj(target) && isObj(source)) {\n    for (const key in source) {\n      if (isObj(source[key])) {\n        if ( ! target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n\n        objectDeepMerge(target[key], source[key]);\n      } else {\n        Object.assign(target, { [key]: source[key] });\n      }\n    }\n  }\n\n  return objectDeepMerge(target, ...sources);\n}\n\nexport function objectDeepClone<T extends DefaultObject>(obj: T): T {\n  if (isObj(obj)) {\n    const copy: { [attr: string]: any } = {};\n\n    for (const attr in obj) {\n      /* istanbul ignore else */\n      if (obj.hasOwnProperty(attr)) {\n        copy[attr] = objectDeepClone(obj[attr]);\n      }\n    }\n\n    return copy as T;\n  }\n\n  return obj;\n}\n\nexport function objectValueByPath<T extends DefaultObject>(\n  obj: T|undefined,\n  path: string,\n  separator: string = '.'\n): any {\n  const keys = path.split(separator);\n  let last = obj;\n\n  while (keys.length > 0) {\n    const key = keys.shift();\n\n    if (typeof last === 'object' && key) {\n      last = last[key];\n    } else {\n      last = undefined;\n      break;\n    }\n  }\n\n  return last;\n}\n","import { Coordinate } from './dimension';\n\nexport function getElementOffset(element: HTMLElement): Coordinate {\n  let x = 0;\n  let y = 0;\n\n  do {\n    x += element.offsetLeft || 0;\n    y += element.offsetTop || 0;\n    element = element.offsetParent as HTMLElement;\n  } while (element);\n\n  return { x, y };\n}\n","import { mapRange } from './math';\n\nexport class Range {\n  public start: number;\n  public end: number;\n\n  public constructor(\n    start: number,\n    end: number,\n  ) {\n    this.start = start > end ? end : start;\n    this.end = end > start ? end : start;\n  }\n\n  public mapTo(\n    val: number,\n    min: number = 0,\n    max: number = 1,\n  ) {\n    return mapRange(val, this.start, this.end, min, max);\n  }\n}\n","export class Resolver<T = void, E = T> {\n  public promise: Promise<T>;\n  private _resolve: (value: T) => void;\n  private _reject: (error: any) => void;\n  private _completed: boolean = false;\n\n  public constructor() {\n    this.promise = new Promise<T>((resolve, reject) => {\n      this._resolve = resolve;\n      this._reject = reject;\n    });\n  }\n\n  public resolve(value?: T) {\n    if (this._completed) {\n      throw new Error('Can\\'t resolve promise. Already completed');\n    }\n\n    this._completed = true;\n    this._resolve(value as T);\n\n    return this.promise;\n  }\n\n  public reject(value?: E) {\n    if (this._completed) {\n      throw new Error('Can\\'t reject promise. Already completed');\n    }\n\n    this._completed = true;\n    this._reject(value);\n\n    return this.promise;\n  }\n\n  public get completed() {\n    return this._completed;\n  }\n}\n","export class Uid {\n  private static next = 0;\n\n  public static reset() {\n    this.next = 0;\n  }\n\n  public static get(prefix = '') {\n    return prefix + (this.next++).toString(36);\n  }\n}\n","export type GoFetch = (\n  ReturnType<typeof fetch> & { controller: AbortController }\n);\n\nexport function goFetch(\n  input: RequestInfo,\n  init?: RequestInit\n) {\n  const controller = new AbortController();\n  const promise = fetch(\n    input,\n    Object.assign({ signal: controller.signal }, init)\n  ) as GoFetch;\n\n  promise.controller = controller;\n\n  return promise;\n}\n","import { Browser } from './browser';\n\nlet parser: HTMLAnchorElement;\n\nexport interface BrowserUrl {\n  protocol: string;\n  host: string;\n  hostname: string;\n  port: string;\n  pathname: string;\n  search: string;\n  hash: string;\n}\n\nexport function parseUrl(url: string): BrowserUrl {\n  if ( ! Browser.client) {\n    throw new Error('URL needs to be parse on the client side');\n  }\n\n  if ( ! parser) {\n    parser = document.createElement('a');\n  }\n\n  parser.href = url;\n\n  return {\n    protocol: parser.protocol,\n    host: parser.host,\n    hostname: parser.hostname,\n    port: parser.port,\n    pathname: parser.pathname,\n    search: parser.search,\n    hash: parser.hash\n  };\n}\n\nexport function serializeUrl(url: BrowserUrl) {\n  return `${url.protocol}//${url.host}${url.pathname}${url.search}${url.hash}`;\n}\n"],"names":["Browser","uA","navigator","userAgent","toLowerCase","pf","platform","safari","test","this","safariVersion","match","replace","firefox","indexOf","chrome","ie","ieMobile","webkit","operaMini","edge","ios","mac","windows","android","androidMobile","blackberry","mobile","mouseWheelEvent","document","wheelEvent","keydownEvent","touchDevice","window","mutationObserver","client","mapRange","value","inStart","inEnd","outMin","outMax","clamp","min","max","Math","lerp","s","e","m","between","num","a","b","roundDec","precision","Number","round","cutDec","str","toString","parseFloat","substring","throttle","cb","ms","ctx","applyTimeout","lastTime","args","now","performance","Date","clearTimeout","setTimeout","apply","isDef","val","undefined","isNum","isStr","isArr","Array","isArray","isObj","type","isFunc","objectDeepMerge","target","sources","length","source","shift","key","Object","assign","[object Object]","objectDeepClone","obj","copy","attr","hasOwnProperty","objectValueByPath","path","separator","keys","split","last","getElementOffset","element","x","y","offsetLeft","offsetTop","offsetParent","Range","start","end","Resolver","promise","Promise","resolve","reject","_resolve","_reject","_completed","Error","completed","Uid","next","prefix","goFetch","input","init","controller","AbortController","fetch","signal","parser","parseUrl","url","createElement","href","protocol","host","hostname","port","pathname","search","hash","serializeUrl"],"mappings":"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"}