{"version":3,"file":"index.umd.js","sources":["../../src/browser.ts","../../src/math.ts","../../src/base.ts","../../src/uid.ts","../../src/url.ts","../../src/range.ts","../../src/resolver.ts","../../src/element.ts","../../src/fetch.ts","../../src/object.ts","../../src/throttle.ts"],"sourcesContent":["export class Browser {\n  public static get uA() {\n    return navigator.userAgent.toLowerCase();\n  }\n\n  public static get pf() {\n    return navigator.platform.toLowerCase();\n  }\n\n  public static get safari() {\n    return (/^((?!chrome|android).)*safari/).test(this.uA);\n  }\n\n  public static get safariVersion() {\n    return +(\n      this.uA.match(/version\\/[\\d\\.]+.*safari/) || ['-1']\n    )[0].replace(/^version\\//, '').replace(/ safari$/, '');\n  }\n\n  public static get firefox() {\n    return this.uA.indexOf('firefox') > -1;\n  }\n\n  public static get chrome() {\n    return (/chrome/).test(this.uA);\n  }\n\n  public static get ie() {\n    return (/msie|trident/).test(this.uA);\n  }\n\n  public static get ieMobile() {\n    return (/iemobile/).test(this.uA);\n  }\n\n  public static get webkit() {\n    return (/webkit/).test(this.uA);\n  }\n\n  public static get operaMini() {\n    return (/opera mini/).test(this.uA);\n  }\n\n  public static get edge() {\n    return (/edge\\/\\d./).test(this.uA);\n  }\n\n  public static get ios() {\n    return (/ip(hone|[ao]d)/).test(this.uA);\n  }\n\n  public static get mac() {\n    return this.pf.indexOf('mac') > -1;\n  }\n\n  public static get windows() {\n    return this.pf.indexOf('win') > -1;\n  }\n\n  public static get android() {\n    return (/android/).test(this.uA);\n  }\n\n  public static get androidMobile() {\n    return (/android.*mobile/).test(this.uA);\n  }\n\n  public static get blackberry() {\n    return (/blackberry/).test(this.uA);\n  }\n\n  public static get mobile() {\n    return this.ieMobile ||\n           this.blackberry ||\n           this.androidMobile ||\n           this.ios ||\n           this.operaMini;\n  }\n\n  /* istanbul ignore next */\n  public static get mouseWheelEvent() {\n    return 'onmousewheel' in document;\n  }\n\n  /* istanbul ignore next */\n  public static get wheelEvent() {\n    return 'onwheel' in document;\n  }\n\n  /* istanbul ignore next */\n  public static get keydownEvent() {\n    return 'onkeydown' in document;\n  }\n\n  /* istanbul ignore next */\n  public static get touchDevice() {\n    return 'ontouchstart' in window;\n  }\n\n  /* istanbul ignore next */\n  public static get mutationObserver() {\n    return 'MutationObserver' in window;\n  }\n\n  /* istanbul ignore next */\n  public static get client() {\n    return typeof window !== 'undefined' &&\n           typeof window.document !== 'undefined';\n  }\n}\n","export function mapRange(\n  value: number,\n  inStart: number,\n  inEnd: number,\n  outMin: number,\n  outMax: number,\n): number {\n  return outMin + (outMax - outMin) / (inEnd - inStart) * (value - inStart);\n}\n\nexport function clamp(\n  value: number,\n  min: number,\n  max: number,\n) {\n  return Math.min(Math.max(value, min), max);\n}\n\nexport function lerp(\n  s: number,\n  e: number,\n  m: number\n) {\n  return s * (1 - m) + e * m;\n}\n\nexport function between(num: number, a: number, b: number) {\n  return num > Math.min(a, b) && num < Math.max(a, b);\n}\n\nexport function roundDec(\n  value: number,\n  precision: number\n) {\n  return Number(\n    Math.round(value + ('e' as any) + precision) + 'e-' + precision\n  );\n}\n\nexport function cutDec(\n  value: number,\n  precision: number\n) {\n  const str = value.toString();\n\n  return parseFloat(str.substring(0, str.indexOf('.') + 1 + precision));\n}\n","type Value<T> = T | undefined | null | void;\n\nexport function isDef<T>(val: Value<T>): val is T {\n  return typeof val !== void 0 && val !== undefined;\n}\n\nexport function isNum<T>(val: Value<T>): val is T {\n  return typeof val === 'number';\n}\n\nexport function isStr<T>(val: Value<T>): val is T {\n  return typeof val === 'string';\n}\n\nexport function isArr<T>(val: Value<T>): val is T {\n  return Array.isArray(val);\n}\n\nexport function isObj<T>(val: Value<T>): val is T {\n  const type = typeof val;\n\n  return !isArr(val) && (\n    type === 'object' &&\n    val != null ||\n    type === 'function'\n  );\n}\n\nexport function isFunc<T>(val: Value<T>): val is T {\n  return typeof val === 'function';\n}\n\n","export class Uid {\n  private static next = 0;\n\n  public static reset() {\n    this.next = 0;\n  }\n\n  public static get(prefix = '') {\n    return prefix + (this.next++).toString(36);\n  }\n}\n","import { Browser } from './browser';\n\nlet parser: HTMLAnchorElement;\n\nexport interface BrowserUrl {\n  protocol: string;\n  host: string;\n  hostname: string;\n  port: string;\n  pathname: string;\n  search: string;\n  hash: string;\n}\n\nexport function parseUrl(url: string): BrowserUrl {\n  if ( ! Browser.client) {\n    throw new Error('URL needs to be parse on the client side');\n  }\n\n  if ( ! parser) {\n    parser = document.createElement('a');\n  }\n\n  parser.href = url;\n\n  return {\n    protocol: parser.protocol,\n    host: parser.host,\n    hostname: parser.hostname,\n    port: parser.port,\n    pathname: parser.pathname,\n    search: parser.search,\n    hash: parser.hash\n  };\n}\n\nexport function serializeUrl(url: BrowserUrl) {\n  return `${url.protocol}//${url.host}${url.pathname}${url.search}${url.hash}`;\n}\n","import { mapRange } from './math';\n\nexport class Range {\n  public start: number;\n  public end: number;\n\n  public constructor(\n    start: number,\n    end: number,\n  ) {\n    this.start = start > end ? end : start;\n    this.end = end > start ? end : start;\n  }\n\n  public mapTo(\n    val: number,\n    min: number = 0,\n    max: number = 1,\n  ) {\n    return mapRange(val, this.start, this.end, min, max);\n  }\n}\n","export class Resolver<T = void, E = T> {\n  public promise: Promise<T>;\n  private _resolve: (value: T) => void;\n  private _reject: (error: any) => void;\n  private _completed: boolean = false;\n\n  public constructor() {\n    this.promise = new Promise<T>((resolve, reject) => {\n      this._resolve = resolve;\n      this._reject = reject;\n    });\n  }\n\n  public resolve(value?: T) {\n    if (this._completed) {\n      throw new Error('Can\\'t resolve promise. Already completed');\n    }\n\n    this._completed = true;\n    this._resolve(value as T);\n\n    return this.promise;\n  }\n\n  public reject(value?: E) {\n    if (this._completed) {\n      throw new Error('Can\\'t reject promise. Already completed');\n    }\n\n    this._completed = true;\n    this._reject(value);\n\n    return this.promise;\n  }\n\n  public get completed() {\n    return this._completed;\n  }\n}\n","import { Coordinate } from './dimension';\n\nexport function getElementOffset(element: HTMLElement): Coordinate {\n  let x = 0;\n  let y = 0;\n\n  do {\n    x += element.offsetLeft || 0;\n    y += element.offsetTop || 0;\n    element = element.offsetParent as HTMLElement;\n  } while (element);\n\n  return { x, y };\n}\n","export type GoFetch = (\n  ReturnType<typeof fetch> & { controller: AbortController }\n);\n\nexport function goFetch(\n  input: RequestInfo,\n  init?: RequestInit\n) {\n  const controller = new AbortController();\n  const promise = fetch(\n    input,\n    Object.assign({ signal: controller.signal }, init)\n  ) as GoFetch;\n\n  promise.controller = controller;\n\n  return promise;\n}\n","import { isObj } from './base';\n\ninterface DefaultObject {\n  [id: string]: any;\n}\n\nexport function objectDeepMerge<T extends DefaultObject>(\n  target: T,\n  ...sources: DefaultObject[]\n): T {\n  if ( ! sources.length) {\n    return target;\n  }\n\n  const source = sources.shift();\n\n  if (isObj(target) && isObj(source)) {\n    for (const key in source) {\n      if (isObj(source[key])) {\n        if ( ! target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n\n        objectDeepMerge(target[key], source[key]);\n      } else {\n        Object.assign(target, { [key]: source[key] });\n      }\n    }\n  }\n\n  return objectDeepMerge(target, ...sources);\n}\n\nexport function objectDeepClone<T extends DefaultObject>(obj: T): T {\n  if (isObj(obj)) {\n    const copy: { [attr: string]: any } = {};\n\n    for (const attr in obj) {\n      /* istanbul ignore else */\n      if (obj.hasOwnProperty(attr)) {\n        copy[attr] = objectDeepClone(obj[attr]);\n      }\n    }\n\n    return copy as T;\n  }\n\n  return obj;\n}\n\nexport function objectValueByPath<T extends DefaultObject>(\n  obj: T|undefined,\n  path: string,\n  separator: string = '.'\n): any {\n  const keys = path.split(separator);\n  let last = obj;\n\n  while (keys.length > 0) {\n    const key = keys.shift();\n\n    if (typeof last === 'object' && key) {\n      last = last[key];\n    } else {\n      last = undefined;\n      break;\n    }\n  }\n\n  return last;\n}\n","export function throttle(\n  cb: Function,\n  ms: number = 0,\n  ctx?: any\n): (...args: any[]) => void {\n  let lastTime = 0;\n  let applyTimeout: any;\n\n  return (...args) => {\n    const now = (performance || /* istanbul ignore next */ Date).now();\n\n    if (lastTime && now < lastTime + ms) {\n      clearTimeout(applyTimeout);\n\n      applyTimeout = setTimeout(function () {\n        lastTime = now;\n        cb.apply(ctx, args);\n      }, ms);\n    } else {\n      lastTime = now;\n\n      cb.apply(ctx, args);\n    }\n  };\n}\n"],"names":["Browser","uA","navigator","userAgent","toLowerCase","pf","platform","safari","test","this","safariVersion","match","replace","firefox","indexOf","chrome","ie","ieMobile","webkit","operaMini","edge","ios","mac","windows","android","androidMobile","blackberry","mobile","mouseWheelEvent","document","wheelEvent","keydownEvent","touchDevice","window","mutationObserver","client","mapRange","value","inStart","inEnd","outMin","outMax","isArr","val","Array","isArray","isObj","type","Uid","[object Object]","next","prefix","toString","parser","start","end","min","max","promise","Promise","resolve","reject","_resolve","_reject","_completed","Error","completed","num","a","b","Math","precision","str","parseFloat","substring","element","x","y","offsetLeft","offsetTop","offsetParent","input","init","controller","AbortController","fetch","Object","assign","signal","undefined","s","e","m","objectDeepClone","obj","copy","attr","hasOwnProperty","objectDeepMerge","target","sources","length","source","shift","key","path","separator","keys","split","last","url","createElement","href","protocol","host","hostname","port","pathname","search","hash","Number","round","cb","ms","ctx","applyTimeout","lastTime","args","now","performance","Date","clearTimeout","setTimeout","apply"],"mappings":"8MAAaA,EACJC,gBACL,OAAOC,UAAUC,UAAUC,cAGtBC,gBACL,OAAOH,UAAUI,SAASF,cAGrBG,oBACL,MAAO,gCAAkCC,KAAKC,KAAKR,IAG9CS,2BACL,QACED,KAAKR,GAAGU,MAAM,6BAA+B,CAAC,OAC9C,GAAGC,QAAQ,aAAc,IAAIA,QAAQ,WAAY,IAG9CC,qBACL,OAAOJ,KAAKR,GAAGa,QAAQ,YAAc,EAGhCC,oBACL,MAAO,SAAWP,KAAKC,KAAKR,IAGvBe,gBACL,MAAO,eAAiBR,KAAKC,KAAKR,IAG7BgB,sBACL,MAAO,WAAaT,KAAKC,KAAKR,IAGzBiB,oBACL,MAAO,SAAWV,KAAKC,KAAKR,IAGvBkB,uBACL,MAAO,aAAeX,KAAKC,KAAKR,IAG3BmB,kBACL,MAAO,YAAcZ,KAAKC,KAAKR,IAG1BoB,iBACL,MAAO,iBAAmBb,KAAKC,KAAKR,IAG/BqB,iBACL,OAAOb,KAAKJ,GAAGS,QAAQ,QAAU,EAG5BS,qBACL,OAAOd,KAAKJ,GAAGS,QAAQ,QAAU,EAG5BU,qBACL,MAAO,UAAYhB,KAAKC,KAAKR,IAGxBwB,2BACL,MAAO,kBAAoBjB,KAAKC,KAAKR,IAGhCyB,wBACL,MAAO,aAAelB,KAAKC,KAAKR,IAG3B0B,oBACL,OAAOlB,KAAKQ,UACLR,KAAKiB,YACLjB,KAAKgB,eACLhB,KAAKY,KACLZ,KAAKU,UAIPS,6BACL,MAAO,iBAAkBC,SAIpBC,wBACL,MAAO,YAAaD,SAIfE,0BACL,MAAO,cAAeF,SAIjBG,yBACL,MAAO,iBAAkBC,OAIpBC,8BACL,MAAO,qBAAsBD,OAIxBE,oBACL,MAAyB,oBAAXF,aACoB,IAApBA,OAAOJ,mBC3GTO,EACdC,EACAC,EACAC,EACAC,EACAC,GAEA,OAAOD,GAAUC,EAASD,IAAWD,EAAQD,IAAYD,EAAQC,YCOnDI,EAASC,GACvB,OAAOC,MAAMC,QAAQF,YAGPG,EAASH,GACvB,MAAMI,SAAcJ,EAEpB,OAAQD,EAAMC,KACH,WAATI,GACO,MAAPJ,GACS,aAATI,SCxBSC,EAGJC,eACLxC,KAAKyC,KAAO,EAGPD,WAAWE,EAAS,IACzB,OAAOA,GAAU1C,KAAKyC,QAAQE,SAAS,KCN3C,IAAIC,EDDaL,OAAO,4BEKtBC,YACEK,EACAC,GAEA9C,KAAK6C,MAAQA,EAAQC,EAAMA,EAAMD,EACjC7C,KAAK8C,IAAMA,EAAMD,EAAQC,EAAMD,EAG1BL,MACLN,EACAa,EAAc,EACdC,EAAc,GAEd,OAAOrB,EAASO,EAAKlC,KAAK6C,MAAO7C,KAAK8C,IAAKC,EAAKC,sBCblDR,cAFQxC,iBAAsB,EAG5BA,KAAKiD,QAAU,IAAIC,QAAW,CAACC,EAASC,KACtCpD,KAAKqD,SAAWF,EAChBnD,KAAKsD,QAAUF,IAIZZ,QAAQZ,GACb,GAAI5B,KAAKuD,WACP,MAAM,IAAIC,MAAM,4CAMlB,OAHAxD,KAAKuD,YAAa,EAClBvD,KAAKqD,SAASzB,GAEP5B,KAAKiD,QAGPT,OAAOZ,GACZ,GAAI5B,KAAKuD,WACP,MAAM,IAAIC,MAAM,2CAMlB,OAHAxD,KAAKuD,YAAa,EAClBvD,KAAKsD,QAAQ1B,GAEN5B,KAAKiD,QAGdQ,gBACE,OAAOzD,KAAKuD,wCLVQG,EAAaC,EAAWC,GAC9C,OAAOF,EAAMG,KAAKd,IAAIY,EAAGC,IAAMF,EAAMG,KAAKb,IAAIW,EAAGC,qBAhBjDhC,EACAmB,EACAC,GAEA,OAAOa,KAAKd,IAAIc,KAAKb,IAAIpB,EAAOmB,GAAMC,sBAyBtCpB,EACAkC,GAEA,MAAMC,EAAMnC,EAAMe,WAElB,OAAOqB,WAAWD,EAAIE,UAAU,EAAGF,EAAI1D,QAAQ,KAAO,EAAIyD,iCM3C3BI,GAC/B,IAAIC,EAAI,EACJC,EAAI,EAER,GACED,GAAKD,EAAQG,YAAc,EAC3BD,GAAKF,EAAQI,WAAa,EAC1BJ,EAAUA,EAAQK,mBACXL,GAET,MAAO,CAAEC,EAAAA,EAAGC,EAAAA,uBCPZI,EACAC,GAEA,MAAMC,EAAa,IAAIC,gBACjB1B,EAAU2B,MACdJ,EACAK,OAAOC,OAAO,CAAEC,OAAQL,EAAWK,QAAUN,IAK/C,OAFAxB,EAAQyB,WAAaA,EAEdzB,8BNdgBf,GACvB,YAAsB,WAARA,QAA0B8C,IAAR9C,qBAyBRA,GACxB,MAAsB,mBAARA,oBAvBSA,GACvB,MAAsB,iBAARA,8BAGSA,GACvB,MAAsB,iBAARA,mBDQd+C,EACAC,EACAC,GAEA,OAAOF,GAAK,EAAIE,GAAKD,EAAIC,2CQUXC,EAAyCC,GACvD,GAAIhD,EAAMgD,GAAM,CACd,MAAMC,EAAgC,GAEtC,IAAK,MAAMC,KAAQF,EAEbA,EAAIG,eAAeD,KACrBD,EAAKC,GAAQH,EAAgBC,EAAIE,KAIrC,OAAOD,EAGT,OAAOD,8BAzCOI,EACdC,KACGC,GAEH,IAAOA,EAAQC,OACb,OAAOF,EAGT,MAAMG,EAASF,EAAQG,QAEvB,GAAIzD,EAAMqD,IAAWrD,EAAMwD,GACzB,IAAK,MAAME,KAAOF,EACZxD,EAAMwD,EAAOE,KACRL,EAAOK,IACZlB,OAAOC,OAAOY,EAAQ,CAAElD,CAACuD,GAAM,KAGjCN,EAAgBC,EAAOK,GAAMF,EAAOE,KAEpClB,OAAOC,OAAOY,EAAQ,CAAElD,CAACuD,GAAMF,EAAOE,KAK5C,OAAON,EAAgBC,KAAWC,iCAqBlCN,EACAW,EACAC,EAAoB,KAEpB,MAAMC,EAAOF,EAAKG,MAAMF,GACxB,IAAIG,EAAOf,EAEX,KAAOa,EAAKN,OAAS,GAAG,CACtB,MAAMG,EAAMG,EAAKJ,QAEjB,GAAoB,iBAATM,IAAqBL,EAEzB,CACLK,OAAOpB,EACP,MAHAoB,EAAOA,EAAKL,GAOhB,OAAOK,uBLvDgBC,GACvB,IAAO9G,EAAQmC,OACb,MAAM,IAAI8B,MAAM,4CASlB,OANOZ,IACLA,EAASxB,SAASkF,cAAc,MAGlC1D,EAAO2D,KAAOF,EAEP,CACLG,SAAU5D,EAAO4D,SACjBC,KAAM7D,EAAO6D,KACbC,SAAU9D,EAAO8D,SACjBC,KAAM/D,EAAO+D,KACbC,SAAUhE,EAAOgE,SACjBC,OAAQjE,EAAOiE,OACfC,KAAMlE,EAAOkE,2BHDflF,EACAkC,GAEA,OAAOiD,OACLlD,KAAKmD,MAAMpF,EAAS,IAAckC,GAAa,KAAOA,4BGC7BuC,GAC3B,SAAUA,EAAIG,aAAaH,EAAII,OAAOJ,EAAIO,WAAWP,EAAIQ,SAASR,EAAIS,4BMpCtEG,EACAC,EAAa,EACbC,GAEA,IACIC,EADAC,EAAW,EAGf,MAAO,IAAIC,KACT,MAAMC,GAAOC,aAA0CC,MAAMF,MAEzDF,GAAYE,EAAMF,EAAWH,GAC/BQ,aAAaN,GAEbA,EAAeO,WAAW,WACxBN,EAAWE,EACXN,EAAGW,MAAMT,EAAKG,IACbJ,KAEHG,EAAWE,EAEXN,EAAGW,MAAMT,EAAKG"}